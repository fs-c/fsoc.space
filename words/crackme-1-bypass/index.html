<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"></meta><meta name="viewport"  content="width=device-width, initial-scale=1"></meta><meta name="author"  content="fsoc"></meta><meta name="author"  content="Laurenz Weixlbaumer"></meta><link href="/styles/base.css"  rel="stylesheet"></link><link href="/styles/font.css"  rel="stylesheet"></link><meta name="description"  content="Dynamically generating polygons and smoothing out their edges."></meta><link href="/styles/syntax-theme.css"  rel="stylesheet"></link><meta name="description"  content="Writing a small patcher to remove ads from an electron app with NodeJS."></meta><link href="/styles/syntax-theme.css"  rel="stylesheet"></link><meta name="description"  content="So I added live reloading to dhow, why do I think this is such a big deal"></meta><link href="/styles/syntax-theme.css"  rel="stylesheet"></link><meta name="description"  content="TODO"></meta><link href="/styles/syntax-theme.css"  rel="stylesheet"></link><meta name="description"  content="Reversing an encryptor written in Java, decidedly overusing streams."></meta><link href="/styles/syntax-theme.css"  rel="stylesheet"></link><meta name="description"  content="TODO"></meta><link href="/styles/syntax-theme.css"  rel="stylesheet"></link><meta name="description"  content="Decrypting file contents by reversing the encryption algorithm."></meta><link href="/styles/syntax-theme.css"  rel="stylesheet"></link><meta name="description"  content="I created a GUI for a side project of mine with minimal effort and convenient usage and you can too!"></meta><link href="/styles/syntax-theme.css"  rel="stylesheet"></link><meta name="description"  content="Reversing modern C++ is weird. Purely static analysis to lift out a flag generation algorithm... again!"></meta><link href="/styles/syntax-theme.css"  rel="stylesheet"></link><meta name="description"  content="I can see you! Reading the flag straight from the file."></meta><link href="/styles/syntax-theme.css"  rel="stylesheet"></link><meta name="description"  content="Purely static analysis to lift out a flag generation algorithm. Fun!"></meta><link href="/styles/syntax-theme.css"  rel="stylesheet"></link><meta name="description"  content="Solving a CrackMe wrapped in a well-known game."></meta><link href="/styles/syntax-theme.css"  rel="stylesheet"></link><meta name="description"  content="Solving a very simple .NET CrackMe using dnSpy."></meta><link href="/styles/syntax-theme.css"  rel="stylesheet"></link></head><body><div class="min-h-screen flex flex-col h-full "><header class="container border-b border-gray-300 dark:border-gray-600 mt-4 mb-4 pb-4"><div class="prose dark:prose-invert text-black dark:text-white"><a href="/">fsoc</a> / <a href="/words">words</a></div></header><main class="container prose dark:prose-invert lg:prose-lg pb-8"><h1 class="mt-4">CrackMe I: Bypass.exe</h1><aside class="mb-4 flex flex-row justify-between"><small>Published on 2022-8-16</small><small><a href="https://github.com/fs-c/fsoc.space/edit/workbench/posts/crackme-1-bypass.md">Edit on github</a></small></aside><p>I'm trying to solve (or work on) one reversing challenge on <a href="https://www.hackthebox.com/home/challenges/Reversing">HackTheBox</a> every day, to work on my reversing knowledge. This is day one, with a very easy one: <a href="https://www.hackthebox.com/home/challenges/download/114">Bypass.exe</a>.</p><p>The given file is a .NET executable, which I discovered upon opening it with IDA. Probably not the best way to find out, but it works. I then switched to using dnSpy because, while IDA supports it, their decompiled IL code isn't very readable to me. DnSpy was much more comfortable to work with in this case.</p><p>The program starts out with</p><pre><code class="language-cs">public static void 0()
{
    bool flag = global::0.1();
    bool flag2 = flag;
    if (flag2)
    {
        global::0.2();
    }
    else
    {
        Console.WriteLine(5.0);
        global::0.0();
    }
}</code></pre><p>Here, <code>global::0.1</code> is clearly the authentication mechanism. If it returns true the program proceeds, if it is false we get some kind of message and the mechanism restarts. Looking at the disassembly of the function,</p><pre><code class="language-cs">public static bool 1()
{
    Console.Write(5.1);
    string text = Console.ReadLine();
    Console.Write(5.2);
    string text2 = Console.ReadLine();
    return false;
}</code></pre><p>...it looks like it always returns false? I have to admit, this confused me for a bit. At first I was considering that there might be some arcane way of reading the values of local variables from other places in the program flow and stuff like that. But this is a crackme, the program doesn't have to actually work.</p><p>So I started debugging the game under dnSpy, changing <code>flag2</code> to be true (something that could not be possible without external manipulation) and stepped into <code>global::0.2</code>.</p><pre><code class="language-cs">public static void 2()
{
    string &lt;&lt;EMPTY_NAME&gt;&gt; = 5.3;
    Console.Write(5.4);
    string b = Console.ReadLine();
    bool flag = &lt;&lt;EMPTY_NAME&gt;&gt; == b;
    if (flag)
    {
        Console.Write(5.5 + global::0.2 + 5.6);
    }
    else
    {
        Console.WriteLine(5.7);
        global::0.2();
    }
}</code></pre><p>At this point, the program asks for a "secret key" which is in <code>5.3</code> and trivially readable from the debugger. But knowledge of the key is not required in any case, since I again just set the if-condition to true.</p><p>This causes the flag to be printed out.</p><h2>Conclusion</h2><p>When working with .NET: dnSpy > IDA.</p><p>Regarding the challenge: This felt a little too easy, getting IDA and dnSpy installed probably took more time than actually solving the challenge. But reversing unobfuscated IL code can only be so difficult, so I suppose this was to be expected. It was fun though.</p><script src="https://unpkg.com/prismjs@v1.x/components/prism-core.min.js"></script><script src="https://unpkg.com/prismjs@v1.x/plugins/autoloader/prism-autoloader.min.js"></script></main></div><footer class="flex flex-row justify-between prose dark:prose-invert container text-md py-3 mb-1 border-t border-gray-300 dark:border-gray-600 mt-4"><p class="m-0">Built with <a href="https://github.com/fs-c/dhow/tree/rewrite">fs-c/dhow</a>.</p><a href="/legal">imprint & privacy</a></footer></body></html>