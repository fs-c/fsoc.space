<html lang="en"><head><meta charset="utf-8"></meta><meta name="viewport"  content="width=device-width, initial-scale=1"></meta><meta name="author"  content="fsoc"></meta><meta name="author"  content="Laurenz Weixlbaumer"></meta><link href="/styles/base.css"  rel="stylesheet"></link><title>fsoc.space</title><title>fsoc.space</title><title>fsoc.space</title><title>fsoc.space</title><meta name="description"  content="TODO"></meta><meta name="description"  content="Purely static analysis to lift out a flag generation algorithm. Fun!"></meta><meta name="description"  content="Solving a crackme wrapped in a simple game."></meta></head><body><div class="flex-grow "><header class="container border-b border-gray-300 mt-4 mb-3 pb-1"><div class="prose text-black"><a href="/">fsoc</a> / <a href="/words">words</a></div></header><main class="container prose"><h1>CrackMe II: Hacky Bird</h1><aside class="mb-2 flex flex-row justify-between"><small>Last edited on 2022-8-17</small><small><a href="https://github.com/fs-c/fsoc.space/edit/workbench/posts/crackme-2-hacky-bird.md">Edit on github</a></small></aside><p>You can get the file at <a href="https://www.hackthebox.com/home/challenges/download/192">hackthebox</a>. The program looks to be a clone of <a href="https://flappybird.io/">Flappy Bird</a>.</p><figure role="img"><img src="https://i.imgur.com/GIfSqy3.png" alt=""><figcaption></figcaption></figure><p>My first instinct was to open the program in IDA, which didn't prove to be very useful since it is very large and would likely be very time consuming to fully reverse. The given description hints at beating the game to get the flag, presumably requiring a certain score. Thus I attached Cheat Engine and its debugger to the game, trying to find the memory address of the score counter. After just two iterations (first searching for 3 after getting 3 points, then searching for 0 right after starting a new round) I had found what I was looking for.</p><p>I then tried to freeze the value at some arbitrary very large number, and got the following screen.</p><figure role="img"><img src="https://i.imgur.com/dF497tt.png" alt=""><figcaption></figcaption></figure><p>No dice, doesn't look useful. So there appeared to be some other mechanism at work, which made me want to investigate the relevant parts of the binary. Using the "Find out what writes to this address" functionality of the Cheat Engine debugger yielded a promising <code>inc</code> instruction.</p><figure role="img"><img src="https://i.imgur.com/K2IUDrj.png" alt=""><figcaption></figcaption></figure><p>This instruction is followed immediately by a conditional jump based on <code>score <= 999</code>. So 999 seems to have some significance. Sure enough, freezing the score at 999 yields the flag.</p></main></div><footer class="flex flex-row gap-2 prose container text-sm py-2 border-t border-gray-300 mt-4"><span>Built with <a href="https://github.com/fs-c/dhow/tree/rewrite">fs-c/dhow</a>.</span><div class="flex-grow"></div><a href="/imprint">/imprint</a><a href="/privacy">/privacy</a></footer></body></html>